
;
; Generate SQL INSERT statements, not used in final product
;

(def ids [117
		  125
		  119
		  121
		  123
		  115
		  118
		  129
		  127
		  143
		  137
		  139
		  138
		  142
		  141
		  144
		  147
		  140
		  148
		  145
		  149
		  131
		  150
		  ])


(def values [
			 [79.28	9.40	2.09	90.77	0.00	8.34	0.00	0.89	0.00]
			 [41.30	5.06	1.79	48.16	0.00	51.31	0.00	0.53	0.00]
			 [64.45	0.00	16.13	80.58	0.00	19.42	0.00	0.00	0.00]
			 [31.68	0.00	2.81	34.49	0.00	65.23	0.00	0.28	0.00]
			 [71.28	0.00	6.98	78.26	0.00	19.22	1.58	0.94	0.00]
			 [62.49	3.00	17.21	82.70	0.00	17.30	0.00	0.00	0.00]
			 [82.85	0.00	2.76	85.61	0.58	13.60	0.00	0.21	0.00]
			 [97.79	0.00	0.00	97.79	0.00	2.21	0.00	0.00	0.00]
			 [41.85	0.00	6.31	48.16	25.21	26.62	0.00	0.00	0.00]
			 [68.66	0.00	3.92	72.58	1.13	26.29	0.00	0.00	0.00]
			 [36.98	0.00	8.91	45.89	0.36	53.75	0.00	0.00	0.00]
			 [18.28	4.56	2.72	25.56	5.43	64.56	0.00	0.10	4.35]
			 [73.63	0.00	4.92	78.56	13.46	7.98	0.00	0.00	0.00]
			 [50.95	0.00	2.16	53.11	22.27	24.62	0.00	0.00	0.00]
			 [36.08	0.00	6.13	42.21	0.00	57.03	0.00	0.00	0.76]
			 [50.16	0.00	1.12	51.28	0.81	46.57	1.34	0.00	0.00]
			 [49.65	0.00	0.82	50.47	0.00	49.27	0.00	0.26	0.00]
			 [61.44	0.00	9.76	71.19	5.94	22.39	0.00	0.47	0.00]
			 [29.78	0.00	5.25	35.03	3.01	55.61	0.00	2.59	3.76]
			 [33.26	1.54	4.30	39.10	0.98	59.63	0.00	0.29	0.00]
			 [24.05	0.00	13.48	37.53	11.39	42.78	0.00	8.30	0.00]
			 [31.16	0.00	6.98	38.14	0.00	61.81	0.00	0.05	0.00]
			 [41.51	0.00	2.48	43.99	0.00	56.01	0.00	0.00	0.00]
			 ])


(def fact-ids [116	117	118	146	131	119	120	121	132])


(assert (= (count fact-ids) (count (first values))))


(defn make-sql
  [[a b c]]
  (str "(" a ", " b ", " c "), "))


; generate SQL statements to insert facts
(->>
 (interleave
  (mapcat (partial repeat (count (first values))) ids)
  (cycle fact-ids)
  (flatten values))
 (partition 3)
 (map make-sql)
 (apply str)
 (str "INSERT INTO place_facts (place_id, fact_id, detail_value) VALUES "))

